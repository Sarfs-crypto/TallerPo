from abc import ABC, abstractmethod
from datetime import datetime, time

class Vuelo(ABC):
    def __init__(self, numero_vuelo: str, origen: str, destino: str, fecha_hora: datetime, aerolinea: str,
                 capacidad_maxima: int = 200):
        self.__numero_vuelo = numero_vuelo
        self.__origen = origen
        self.__destino = destino
        self.__fecha_hora = fecha_hora
        self.__aerolinea = aerolinea
        self._pasajeros_registrados = []
        self.__capacidad_maxima = capacidad_maxima

    @abstractmethod
    def calcular_tarifa_base(self) -> float: pass

    @abstractmethod
    def obtener_documentos_requeridos(self) -> list: pass

    def registrar_pasajero(self, pasajero) -> bool:
        if self.__validar_capacidad():
            self._pasajeros_registrados.append(pasajero)
            return True
        return False

    def __validar_capacidad(self) -> bool:
        return len(self._pasajeros_registrados) < self.__capacidad_maxima

    def get_numero_vuelo(self) -> str: return self.__numero_vuelo

    def get_origen(self) -> str: return self.__origen

    def get_destino(self) -> str: return self.__destino

    def get_pasajeros_registrados(self) -> list: return self._pasajeros_registrados.copy()


class VueloDomestico(Vuelo):
    def __init__(self, numero_vuelo: str, origen: str, destino: str, fecha_hora: datetime, aerolinea: str,
                 duracion_horas: float, escala: bool):
        super().__init__(numero_vuelo, origen, destino, fecha_hora, aerolinea)
        self.duracion_horas = duracion_horas
        self.escala = escala

    def calcular_tarifa_base(self) -> float:
        return 100 + (50 if self.escala else 0)

    def obtener_documentos_requeridos(self) -> list:
        return ["Cédula", "Tarjeta de embarque"]


class VueloInternacional(Vuelo):
    def __init__(self, numero_vuelo: str, origen: str, destino: str, pais_destino: str, fecha_hora: datetime,
                 aerolinea: str, visa_requerida: bool):
        super().__init__(numero_vuelo, origen, destino, fecha_hora, aerolinea)
        self.pais_destino = pais_destino
        self.visa_requerida = visa_requerida

    def calcular_tarifa_base(self) -> float:
        return 500 + (100 if self.visa_requerida else 0)

    def obtener_documentos_requeridos(self) -> list:
        documentos = ["Pasaporte", "Tarjeta de embarque"]
        if self.visa_requerida:
            documentos.append("Visa")
        return documentos


class VueloCarga(Vuelo):
    def __init__(self, numero_vuelo: str, origen: str, destino: str, fecha_hora: datetime, aerolinea: str,
                 peso_carga_kg: float, tipo_mercancia: str):
        super().__init__(numero_vuelo, origen, destino, fecha_hora, aerolinea, 1)
        self.peso_carga_kg = peso_carga_kg
        self.tipo_mercancia = tipo_mercancia

    def calcular_tarifa_base(self) -> float:
        return self.peso_carga_kg * 2.5

    def obtener_documentos_requeridos(self) -> list:
        return ["Manifiesto de carga", f"Certificado de {self.tipo_mercancia}"]

    def registrar_pasajero(self, pasajero) -> bool:
        return False


class VueloPrivado(Vuelo):
    def __init__(self, numero_vuelo: str, origen: str, destino: str, fecha_hora: datetime, aerolinea: str,
                 cliente: str):
        super().__init__(numero_vuelo, origen, destino, fecha_hora, aerolinea, 20)
        self.cliente = cliente

    def calcular_tarifa_base(self) -> float:
        return 5000

    def obtener_documentos_requeridos(self) -> list:
        return ["Identificación oficial", "Contrato de charter"]


# ... (Las clases Pasajero, ServicioAeropuerto y EmpleadoAeropuerto se mantienen igual) ...

class Pasajero(ABC):
    def __init__(self, nombre: str, pasaporte: str, nacionalidad: str, edad: int):
        self.__nombre = nombre
        self.__pasaporte = pasaporte
        self.__nacionalidad = nacionalidad
        self.__edad = edad
        self._equipaje = []

    @abstractmethod
    def calcular_costo_total(self) -> float: pass

    @abstractmethod
    def obtener_beneficios(self) -> list: pass

    def agregar_equipaje(self, maleta: dict) -> bool:
        if maleta.get("peso_kg", 0) <= 23:
            self._equipaje.append(maleta)
            return True
        return False

    def __calcular_impuestos(self, tarifa_base: float) -> float:
        return tarifa_base * 0.18

    def get_nombre(self) -> str: return self.__nombre

    def get_pasaporte(self) -> str: return self.__pasaporte


class PasajeroEconomico(Pasajero):
    def __init__(self, nombre: str, pasaporte: str, nacionalidad: str, edad: int, asiento_estandar: str):
        super().__init__(nombre, pasaporte, nacionalidad, edad)
        self.asiento_estandar = asiento_estandar
        self.__tarifa_base = 150

    def calcular_costo_total(self) -> float:
        costo = self.__tarifa_base
        if len(self._equipaje) > 1:
            costo += 50
        return costo + self._Pasajero__calcular_impuestos(costo)

    def obtener_beneficios(self) -> list:
        return ["Asiento estándar", "1 equipaje de mano"]


class PasajeroEjecutivo(Pasajero):
    def __init__(self, nombre: str, pasaporte: str, nacionalidad: str, edad: int, asiento_reclinable: str):
        super().__init__(nombre, pasaporte, nacionalidad, edad)
        self.asiento_reclinable = asiento_reclinable
        self.__tarifa_base = 400

    def calcular_costo_total(self) -> float:
        return self.__tarifa_base + self._Pasajero__calcular_impuestos(self.__tarifa_base)

    def obtener_beneficios(self) -> list:
        return ["Asiento reclinable", "Prioridad en embarque", "Comida gourmet"]


class PasajeroPrimeraClase(Pasajero):
    def __init__(self, nombre: str, pasaporte: str, nacionalidad: str, edad: int):
        super().__init__(nombre, pasaporte, nacionalidad, edad)
        self.__tarifa_base = 1000

    def calcular_costo_total(self) -> float:
        return self.__tarifa_base + self._Pasajero__calcular_impuestos(self.__tarifa_base)

    def obtener_beneficios(self) -> list:
        return ["Suite privada", "Chofer privado", "Equipaje ilimitado"]


class Tripulacion(Pasajero):
    def __init__(self, nombre: str, pasaporte: str, nacionalidad: str, edad: int, rol: str):
        super().__init__(nombre, pasaporte, nacionalidad, edad)
        self.rol = rol

    def calcular_costo_total(self) -> float:
        return 0.0

    def obtener_beneficios(self) -> list:
        return ["Vuelo gratuito", "Alojamiento", "Dieta por servicio"]


class ServicioAeropuerto(ABC):
    def __init__(self, codigo_servicio: str, ubicacion: str, horario_apertura: time):
        self.__codigo_servicio = codigo_servicio
        self.__ubicacion = ubicacion
        self.__horario_apertura = horario_apertura
        self._clientes_atendidos = []

    @abstractmethod
    def calcular_tarifa(self) -> float: pass

    @abstractmethod
    def verificar_disponibilidad(self) -> bool: pass

    def registrar_uso(self, cliente: str) -> bool:
        if self.verificar_disponibilidad():
            self._clientes_atendidos.append(cliente)
            return True
        return False

    def get_codigo_servicio(self) -> str: return self.__codigo_servicio


class SalaVIP(ServicioAeropuerto):
    def __init__(self, codigo_servicio: str, ubicacion: str, horario_apertura: time):
        super().__init__(codigo_servicio, ubicacion, horario_apertura)
        self.__tarifa_fija = 100

    def calcular_tarifa(self) -> float:
        return self.__tarifa_fija

    def verificar_disponibilidad(self) -> bool:
        return len(self._clientes_atendidos) < 50


class Estacionamiento(ServicioAeropuerto):
    def __init__(self, codigo_servicio: str, ubicacion: str, horario_apertura: time):
        super().__init__(codigo_servicio, ubicacion, horario_apertura)
        self.__tarifa_por_hora = 5

    def calcular_tarifa(self) -> float:
        return self.__tarifa_por_hora * 24

    def verificar_disponibilidad(self) -> bool:
        return True


class CambioMoneda(ServicioAeropuerto):
    def __init__(self, codigo_servicio: str, ubicacion: str, horario_apertura: time):
        super().__init__(codigo_servicio, ubicacion, horario_apertura)
        self.comision = 10

    def calcular_tarifa(self) -> float:
        return self.comision

    def verificar_disponibilidad(self) -> bool:
        return datetime.now().time() >= self._ServicioAeropuerto__horario_apertura


class DutyFree(ServicioAeropuerto):
    def calcular_tarifa(self) -> float:
        return 0.0

    def verificar_disponibilidad(self) -> bool:
        return datetime.now().time() >= self._ServicioAeropuerto__horario_apertura


class EmpleadoAeropuerto(ABC):
    def __init__(self, nombre: str, codigo: str, area: str, turno: str):
        self.__nombre = nombre
        self.__codigo = codigo
        self.__area = area
        self.__turno = turno
        self._certificaciones = []

    @abstractmethod
    def calcular_salario(self) -> float:
        pass

    @abstractmethod
    def realizar_tarea_principal(self) -> str:
        pass

    def registrar_turno(self, nuevo_turno: str):
        self.__turno = nuevo_turno

    def __calcular_bono_turno(self, salario_base: float) -> float:
        if self.__turno == "nocturno":
            return salario_base * 0.25
        elif self.__turno == "mixto":
            return salario_base * 0.15
        return 0.0

    def get_nombre(self) -> str:
        return self.__nombre


class AgenteCheckIn(EmpleadoAeropuerto):
    def __init__(self, nombre: str, codigo: str, area: str, turno: str, counter_asignado: str):
        super().__init__(nombre, codigo, area, turno)
        self.counter_asignado = counter_asignado
        self.__salario_base = 2500

    def calcular_salario(self) -> float:
        return self.__salario_base + self._EmpleadoAeropuerto__calcular_bono_turno(self.__salario_base)

    def realizar_tarea_principal(self) -> str:
        return f"Realizando check-in en counter {self.counter_asignado}"


class AgenteSeguridad(EmpleadoAeropuerto):
    def __init__(self, nombre: str, codigo: str, area: str, turno: str, zona_asignada: str):
        super().__init__(nombre, codigo, area, turno)
        self.zona_asignada = zona_asignada
        self.__salario_base = 3000

    def calcular_salario(self) -> float:
        return self.__salario_base + self._EmpleadoAeropuerto__calcular_bono_turno(self.__salario_base)

    def realizar_tarea_principal(self) -> str:
        return f"Realizando controles de seguridad en {self.zona_asignada}"


class OficialMigracion(EmpleadoAeropuerto):
    def __init__(self, nombre: str, codigo: str, area: str, turno: str):
        super().__init__(nombre, codigo, area, turno)
        self.__salario_base = 3500

    def calcular_salario(self) -> float:
        return self.__salario_base + self._EmpleadoAeropuerto__calcular_bono_turno(self.__salario_base)

    def realizar_tarea_principal(self) -> str:
        return "Procesando documentación migratoria"


class Mantenimiento(EmpleadoAeropuerto):
    def __init__(self, nombre: str, codigo: str, area: str, turno: str, especialidad: str):
        super().__init__(nombre, codigo, area, turno)
        self.especialidad = especialidad
        self.__salario_base = 2800

    def calcular_salario(self) -> float:
        return self.__salario_base + self._EmpleadoAeropuerto__calcular_bono_turno(self.__salario_base)

    def realizar_tarea_principal(self) -> str:
        return f"Realizando mantenimiento en {self.especialidad}"


def main():
    print("=" * 60)
    print("SISTEMA DE AEROPUERTO - COLOMBIA")
    print("=" * 60)

    # VUELOS DESDE MEDELLÍN Y BOGOTÁ
    print("\n1. VUELOS DESDE MEDELLÍN Y BOGOTÁ")
    print("-" * 40)

    vuelos = [
        # Vuelos desde Bogotá
        VueloDomestico("BOG101", "Bogotá", "Cartagena", datetime(2025, 6, 15, 8, 0), "Avianca", 1.5, False),
        VueloDomestico("BOG202", "Bogotá", "Cali", datetime(2021, 6, 16, 10, 0), "LATAM", 1.2, False),
        VueloDomestico("BOG303", "Bogotá", "Santa Marta", datetime(2024, 6, 17, 12, 0), "Viva Air", 1.8, True),

        VueloInternacional("BOG501", "Bogotá", "Miami", "USA", datetime(2023, 6, 18, 14, 0), "Avianca", True),
        VueloInternacional("BOG602", "Bogotá", "Madrid", "España", datetime(2023, 6, 19, 16, 0), "LATAM", False),
        VueloInternacional("BOG703", "Bogotá", "Ciudad de México", "México", datetime(2025, 6, 20, 18, 0), "United",
                           True),

        # Vuelos desde Medellín
        VueloDomestico("MDE101", "Medellín", "Bogotá", datetime(2024, 2, 15, 9, 0), "Avianca", 1.0, False),
        VueloDomestico("MDE202", "Medellín", "Cartagena", datetime(2025, 7, 16, 11, 0), "LATAM", 1.3, True),
        VueloDomestico("MDE303", "Medellín", "San Andrés", datetime(2022, 8, 17, 13, 0), "Viva Air", 2.0, False),

        VueloInternacional("MDE501", "Medellín", "Miami", "USA", datetime(2010, 5, 18, 15, 0), "Avianca", True),
        VueloInternacional("MDE602", "Medellín", "Panamá", "Panamá", datetime(2020, 3, 19, 17, 0), "Copa Airlines",
                           False),
        VueloInternacional("MDE703", "Medellín", "Lima", "Perú", datetime(2025, 5, 20, 19, 0), "LATAM", False),

        # Vuelos de carga y privados desde ambas ciudades
        VueloCarga("FX801", "Bogotá", "Miami", datetime(2025, 9, 21, 20, 0), "FedEx", 5000, "electrónicos"),
        VueloCarga("DHL802", "Medellín", "Santiago", datetime(2025, 8, 22, 22, 0), "DHL", 3000, "documentos"),
        VueloCarga("UPS803", "Bogotá", "Lima", datetime(2025, 4, 23, 6, 0), "UPS", 7000, "farmacéuticos"),

        VueloPrivado("PJ901", "Bogotá", "París", datetime(2025, 3, 24, 10, 0), "Private Jets", "Empresa ABC"),
        VueloPrivado("PJ902", "Medellín", "Dubai", datetime(2024, 5, 25, 12, 0), "Private Jets", "Familia XYZ"),
        VueloPrivado("PJ903", "Bogotá", "Tokio", datetime(2025, 9, 26, 14, 0), "Private Jets", "Gobierno")
    ]

    for vuelo in vuelos:
        print(
            f"{vuelo.get_numero_vuelo()}: {vuelo.get_origen()} → {vuelo.get_destino()} - ${vuelo.calcular_tarifa_base():.0f}")

    # PASAJEROS (se mantiene igual)
    print("\n2. PASAJEROS")
    print("-" * 40)

    pasajeros = [
        PasajeroEconomico("Carlos López", "CL123456", "Colombiano", 35, "15A"),
        PasajeroEconomico("Ana García", "AG789012", "Colombiana", 28, "16B"),
        PasajeroEconomico("Pedro Martínez", "PM345678", "Colombiano", 42, "17C"),

        PasajeroEjecutivo("María Rodríguez", "MR901234", "Colombiana", 45, "2A"),
        PasajeroEjecutivo("José Hernández", "JH567890", "Colombiano", 38, "2B"),
        PasajeroEjecutivo("Laura Díaz", "LD123789", "Colombiana", 41, "2C"),

        PasajeroPrimeraClase("Roberto Silva", "RS456123", "Colombiano", 55),
        PasajeroPrimeraClase("Carmen Vargas", "CV789456", "Colombiana", 52),
        PasajeroPrimeraClase("Fernando Castro", "FC123987", "Colombiano", 48),

        Tripulacion("Sofia Méndez", "SM654321", "Colombiana", 32, "Comandante"),
        Tripulacion("David Rojas", "DR987654", "Colombiano", 29, "Copiloto"),
        Tripulacion("Elena Torres", "ET321654", "Colombiana", 34, "Azafata")
    ]

    for i, pasajero in enumerate(pasajeros[:6]):
        pasajero.agregar_equipaje({"peso_kg": 15, "tipo": "maleta"})
        print(f"{pasajero.get_nombre()}: ${pasajero.calcular_costo_total():.0f}")

    # SERVICIOS (se mantiene igual)
    print("\n3. SERVICIOS AEROPORTUARIOS")
    print("-" * 40)

    servicios = [
        SalaVIP("SV001", "Terminal 1", time(6, 0)),
        Estacionamiento("EST001", "Terminal 1", time(0, 0)),
        CambioMoneda("CM001", "Hall Principal", time(8, 0)),
        DutyFree("DF001", "Terminal Internacional", time(6, 0))
    ]

    for servicio in servicios:
        servicio.registrar_uso("Cliente Ejemplo")
        print(f"{servicio.get_codigo_servicio()}: ${servicio.calcular_tarifa():.0f}")

    # EMPLEADOS (se mantiene igual)
    print("\n4. PERSONAL AEROPORTUARIO")
    print("-" * 40)

    empleados = [
        AgenteCheckIn("Luisa Fernández", "ACH001", "Check-In", "diurno", "Counter 5"),
        AgenteCheckIn("Andrés Ramírez", "ACH002", "Check-In", "nocturno", "Counter 6"),
        AgenteCheckIn("Carolina Reyes", "ACH003", "Check-In", "diurno", "Counter 7"),

        AgenteSeguridad("Miguel Ortiz", "ASG001", "Seguridad", "nocturno", "Control Metálico"),
        AgenteSeguridad("Patricia Cruz", "ASG002", "Seguridad", "diurno", "Salidas"),
        AgenteSeguridad("Javier Mendoza", "ASG003", "Seguridad", "nocturno", "Llegadas"),

        OficialMigracion("Gabriela Peña", "OMG001", "Migración", "mixto"),
        OficialMigracion("Ricardo Guzmán", "OMG002", "Migración", "diurno"),
        OficialMigracion("Daniela Herrera", "OMG003", "Migración", "mixto"),

        Mantenimiento("Oscar Núñez", "MNT001", "Mantenimiento", "nocturno", "electricidad"),
        Mantenimiento("Natalia Vega", "MNT002", "Mantenimiento", "diurno", "aviónica"),
        Mantenimiento("Héctor Ríos", "MNT003", "Mantenimiento", "nocturno", "motores")
    ]

    for empleado in empleados[:6]:
        print(f"{empleado.get_nombre()}: ${empleado.calcular_salario():.0f}")

    # REPORTES FINALES
    print("\n5. REPORTES FINALES")
    print("-" * 40)

    ingresos_vuelos = sum(v.calcular_tarifa_base() for v in vuelos)
    costos_pasajeros = sum(p.calcular_costo_total() for p in pasajeros)
    ingresos_servicios = sum(s.calcular_tarifa() for s in servicios)
    planilla_total = sum(e.calcular_salario() for e in empleados)

    print(f"Ingresos por vuelos: ${ingresos_vuelos:,.0f}")
    print(f"Costos de pasajeros: ${costos_pasajeros:,.0f}")
    print(f"Ingresos por servicios: ${ingresos_servicios:,.0f}")
    print(f"Planilla mensual: ${planilla_total:,.0f}")


if __name__ == "__main__":
    main()
